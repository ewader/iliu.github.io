<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Oss on 老刘博客</title>
    <link>https://iliu.org/tags/oss/</link>
    <description>Recent content in Oss on 老刘博客</description>
    <image>
      <title>老刘博客</title>
      <url>https://iliu.org/img/liujinsuiyue.jpg</url>
      <link>https://iliu.org/img/liujinsuiyue.jpg</link>
    </image>
    <generator>Hugo -- 0.154.5</generator>
    <language>zh-cn</language>
    <lastBuildDate>Mon, 15 Jul 2019 03:27:27 +0000</lastBuildDate>
    <atom:link href="https://iliu.org/tags/oss/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>备忘，使用阿里云ossfs备份网站</title>
      <link>https://iliu.org/2513.html</link>
      <pubDate>Mon, 15 Jul 2019 03:27:27 +0000</pubDate>
      <guid>https://iliu.org/2513.html</guid>
      <description>&lt;p&gt;昨天看到明月云服务上有篇关于使用ossfs备份网站的文章，看起来也不复杂，于是就试用了一下，试用后感觉真是体验不错，用这个后，妈妈再也不担心网站数据丢失了。&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>昨天看到明月云服务上有篇关于使用ossfs备份网站的文章，看起来也不复杂，于是就试用了一下，试用后感觉真是体验不错，用这个后，妈妈再也不担心网站数据丢失了。</p>
<h2 id="给服务器安装ossfs">给服务器安装ossfs。</h2>
<ul>
<li>下载安装包</li>
</ul>
<pre class="ql-syntax" spellcheck="false"><span class="hljs-attribute">wget</span> http://gosspublic.alicdn.com/ossfs/ossfs_1.80.6_centos7.0_x86_64.rpm
</pre>
<p>这个可以到阿里云官网上下载最新的版本。</p>
<ul>
<li>安装，这里是centos7.x的安装方式</li>
</ul>
<pre class="ql-syntax" spellcheck="false">sudo yum localinstall ossfs_1.80.6_centos7.0_x86_64.rpm
</pre>
<ul>
<li><span style="background-color: rgb(255, 255, 255); color: rgb(51, 51, 51);">配置账号访问信息</span></li>
</ul>
<pre class="ql-syntax" spellcheck="false">echo <span class="hljs-keyword">my</span>-bucket:<span class="hljs-keyword">my</span>-access-key-id:<span class="hljs-keyword">my</span>-access-key-secret &gt; <span class="hljs-regexp">/etc/passwd</span>-ossfs
<span class="hljs-keyword">chmod</span> <span class="hljs-number">640</span> /etc/passwd-ossfs
ossfs <span class="hljs-keyword">my</span>-bucket <span class="hljs-keyword">my</span>-mount-point -ourl=<span class="hljs-keyword">my</span>-oss-endpoint
</pre>
<p>例如，本人用的香港阿里云服务器，配置就是这么做的</p>
<pre class="ql-syntax" spellcheck="false">echo bucket-test:LTAIbZcdVCmQ****:MOk8x0y9hxQ31coh7A5e2MZEUz**** &gt; <span class="hljs-regexp">/etc/</span>passwd-ossfs
chmod <span class="hljs-number">640</span> /etc/passwd-ossfs
mkdir /tmp/ossfs
ossfs bucket-test /tmp/ossfs -ourl=http:<span class="hljs-comment">//oss-cn-hongkong-internal.aliyuncs.com</span>
</pre>
<p>如果服务器不在阿里云，那么就不要用内网传输，至此，安装完毕，已经可以试用了，利用oneinstak的备份脚本，选择本地备份，目录选择刚才新建的/tmp/ossfs，即可，备份成功后，可以到oss里看一下，确实已经存在了，速度非常的快。<figure class="content-img-box" id="2512"></p>
<p><img decoding="async" alt="备忘，使用阿里云ossfs备份网站" src="https://tunan.org/wp-content/uploads/2019/07/1280634b25f8ed.jpg" id="97E59226" class="po-img-big" /> <figcaption class="addDesn"></figcaption></figure></p>
<h2 id="开机后自动挂载ossfs">开机后自动挂载ossfs</h2>
<p>上面的设置后，服务器不能重启，所以还要进一步的设置一下。</p>
<p><span style="background-color: rgb(255, 255, 255); color: rgb(51, 51, 51);">在/etc/init.d/目录下建立文件 ossfs，把模板文件中的内容拷贝到这个新文件中。并将其中的 your_xxx 内容改成您自己的信息。</span></p>
<pre class="ql-syntax" spellcheck="false"><span class="hljs-meta">#! /bin/bash</span>
<span class="hljs-comment"># ossfs      Automount Aliyun OSS Bucket in the specified direcotry.</span>
<span class="hljs-comment"># chkconfig: 2345 90 10</span>
<span class="hljs-comment"># description: Activates/Deactivates ossfs configured to start at boot time.</span>
 ossfs your_bucket your_mountpoint -ourl=your_url -oallow_other
</pre>
<p>执行如下命令：</p>
<pre class="ql-syntax" spellcheck="false"><span class="hljs-attribute">chmod</span> a+x /etc/init.d/ossfs
chkconfig ossfs <span class="hljs-literal">on</span>
</pre>
<p>这样就完全不用担心重启服务器了，以后如果必须要重装服务器的话，重装玩后，可以直接通过内容把备份的东西拷贝回服务器，一般都是秒传。</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
