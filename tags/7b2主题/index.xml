<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>7b2主题 on 老刘博客</title>
    <link>http://localhost:1313/tags/7b2%E4%B8%BB%E9%A2%98/</link>
    <description>Recent content in 7b2主题 on 老刘博客</description>
    <image>
      <title>老刘博客</title>
      <url>http://localhost:1313/img/liujinsuiyue.jpg</url>
      <link>http://localhost:1313/img/liujinsuiyue.jpg</link>
    </image>
    <generator>Hugo -- 0.152.2</generator>
    <language>zh-cn</language>
    <lastBuildDate>Wed, 12 Jun 2019 02:04:14 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/7b2%E4%B8%BB%E9%A2%98/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>7b2主题每日签到不刷新的解决办法</title>
      <link>http://localhost:1313/1710.html</link>
      <pubDate>Wed, 12 Jun 2019 02:04:14 +0000</pubDate>
      <guid>http://localhost:1313/1710.html</guid>
      <description>&lt;p&gt;前一段时间忽然发现跋涉者另外一个网站&lt;a href=&#34;https://www.yanjingweb.cn&#34; target=&#34;_blank&#34; rel=&#34;noopener noreferrer&#34;&gt;镜缘轩&lt;/a&gt;上每日签到抽取积分的那个选项不能自动刷新了，每天都是显示同一样的数字，然后看明月登楼的一个网站，也是有这样的问题，咨询主题的作者之后，也没有能排查到问题，最后作者说反正新版就要出来了，不行到时候直接上新版吧。&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>前一段时间忽然发现跋涉者另外一个网站<a href="https://www.yanjingweb.cn" target="_blank" rel="noopener noreferrer">镜缘轩</a>上每日签到抽取积分的那个选项不能自动刷新了，每天都是显示同一样的数字，然后看明月登楼的一个网站，也是有这样的问题，咨询主题的作者之后，也没有能排查到问题，最后作者说反正新版就要出来了，不行到时候直接上新版吧。</p>
<p>后来陆续发现，不但每日签到抽取积分有问题，另外还有<span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255);">发布冒泡没有积分，发文章没有积分，别人回复收不到消息 海报不能下载、以及别人购买了文章等也没有通知等问题，这下就问题有点大了，签到那个还无所谓，后面出现的问题有点烦人。但是跋涉者这个网站是没有任何问题的。</span></p>
<p><span style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255);">当时想是不是因为空间配置、缓存等等的原因造成的，于是把网站弄到一个空间，还是一个有问题，一个没问题。适逢一个群里的朋友让测试评论邮件回复的问题，因为这个主题也没有评论邮件回复，于是咨询了一下，不想还引出诸多大佬们说我设置的问题，他们使用就很正常云云。其实这个问题根本不是跋涉者的问题，因为我询问过主题的作者，作者答复</span></p>
<blockquote>
<p><strong style="color: rgb(51, 51, 51); background-color: rgb(255, 255, 255);">不需要这个功能，如果用这个的话，用不了几天你的邮箱就被拉黑了</strong></p>
</blockquote>
<p>其实说我设置有问题的大佬们根本就没有测试，于是就想当然的认为默认评论是发邮件的，这个问题说实话跋涉者之前也没注意，是张波博客的博主发现我给他的回复没有收到邮件。这些都是题外话，貌似这段跑题了。</p>
<p>话转回到真正遇到的问题，跋涉者开始排除到底是怎么造成的，刚用这个主题的时候，一切功能都是正常的，后来比较了两个网站所用的插件发现，镜缘轩这个网站比跋涉者的网站多加了一个自动推送文章到百度百家号的插件，由于其他都是一样的，跋涉者就决定先把这个插件禁用看看是什么效果。</p>
<p>禁用后发了一个冒泡，然后财富了看了下，积分加上了，又用另一个小号发了一篇文章，积分有了，试着回复一下文章，通知出来了，今天早上，签到随机抽取积分的选项也出来了。</p>
<p>至此，终于确定了问题所出，那就是主题和自动推送文章到百家号的插件冲突造成的，把百家号插件禁用即可。如果你使用这个主题的时候也出现了类似的问题，不妨禁用一下除作者推荐的插件外的其他插件，一个一个的排除，相信问题也是可以解决的。</p>
<h2 id="ps上述的原因是错的现在真正的原因找到了">PS，上述的原因是错的，现在真正的原因找到了</h2>
<p>原来以为是和百家号有冲突造成的，后来发现禁用了百家号的推送后还是不行，然后就想自己对网站做了什么，最后想到没做什么，只不过是把cdn从又拍云换到了上海云顿，赶紧换回来，结果问题马上就解决了。</p>
<p>原来，不是插件的原因，上次禁用百家号的插件的时候刚巧从云盾换成又拍云。唉，最后的问题终于找到了。</p>
]]></content:encoded>
    </item>
    <item>
      <title>7b2主题添加百度是否收录及禁止非管理员访问后台</title>
      <link>http://localhost:1313/1636.html</link>
      <pubDate>Sat, 25 May 2019 07:00:29 +0000</pubDate>
      <guid>http://localhost:1313/1636.html</guid>
      <description>&lt;p&gt;原来使用的是知更鸟的begin主题，和7b2的主题可以说是侧重点不同，不可否认的是7b2主题 在展示网页的方面和begin有一定的差距，比如begin里的一些小功能，其中百度是否收录就是其中的一项，让让人只管的文章用不要再次提交，不过要实现这个也不是一件很难的事情，之间在functions.php里添加一些代码就可以了。&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>原来使用的是知更鸟的begin主题，和7b2的主题可以说是侧重点不同，不可否认的是7b2主题 在展示网页的方面和begin有一定的差距，比如begin里的一些小功能，其中百度是否收录就是其中的一项，让让人只管的文章用不要再次提交，不过要实现这个也不是一件很难的事情，之间在functions.php里添加一些代码就可以了。</p>
<h2 id="添加百度是否收录的代码管理员可见">添加百度是否收录的代码（管理员可见）</h2>
<pre class="ql-syntax" spellcheck="false"><span class="hljs-comment">/*
判断当前文章是否被百度收录，若没有被收录则可点击提交至百度，加速收录！(此插件在文章页面仅管理员可见) 
*/</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">d4v</span><span class="hljs-params">($url)</span></span>{
    $url=<span class="hljs-string">'http://www.baidu.com/s?wd='</span>.$url;
    $curl=curl_init();
    curl_setopt($curl,CURLOPT_URL,$url);
    curl_setopt($curl,CURLOPT_RETURNTRANSFER,<span class="hljs-number">1</span>);
    $rs=curl_exec($curl);
    curl_close($curl);
    <span class="hljs-keyword">if</span>(!strpos($rs,<span class="hljs-string">'没有找到'</span>)){
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-number"></span>;
    }
}
add_filter( <span class="hljs-string">'the_content'</span>,  <span class="hljs-string">'baidu_submit'</span> );
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">baidu_submit</span><span class="hljs-params">( $content )</span> </span>{
    <span class="hljs-keyword">if</span>( is_single() && current_user_can( <span class="hljs-string">'manage_options'</span>) )
        <span class="hljs-keyword">if</span>(d4v(get_permalink()) == <span class="hljs-number">1</span>)
            $content=<span class="hljs-string">"
百度已收录(仅管理员可见)
"</span>.$content;
        <span class="hljs-keyword">else</span>
            $content=<span class="hljs-string">"
.get_permalink()."</span>&gt;百度未收录!点击此处提交(仅管理员可见)
<span class="hljs-string">".$content;
        return $content;
    }
</span></pre>
<p>第二就是7b2主题提供了强大的前台及用户中心功能，对于普通用户来说，没有必要让他们进入网站的后台。因此，我们可以添加一些代码来禁止普通的用户进入后台。</p>
<h2 id="禁止非管理员访问后台">禁止非管理员访问后台</h2>
<pre class="ql-syntax" spellcheck="false"><span class="hljs-comment">/**
 * 禁止非管理员访问后台并限制访问后台登录注册
 * <span class="hljs-doctag">@package</span> bertly
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">redirect_non_admin_users</span><span class="hljs-params">()</span> </span>{
	<span class="hljs-keyword">if</span> ( ! current_user_can( <span class="hljs-string">'manage_options'</span> ) && <span class="hljs-string">'/wp-admin/admin-ajax.php'</span> != $_SERVER[<span class="hljs-string">'PHP_SELF'</span>] ) {
		wp_redirect( home_url() );
		<span class="hljs-keyword">exit</span>;
	}
}
add_action( <span class="hljs-string">'admin_init'</span>, <span class="hljs-string">'redirect_non_admin_users'</span> );
add_action(<span class="hljs-string">'login_enqueue_scripts'</span>,<span class="hljs-string">'login_protection'</span>);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login_protection</span><span class="hljs-params">()</span></span>{
        header(<span class="hljs-string">'Location: /'</span>);
    }
<span class="hljs-comment">/**
 * End
 */</span>
</pre>]]></content:encoded>
    </item>
  </channel>
</rss>
