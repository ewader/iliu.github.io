<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Cloudflare on 老刘博客</title>
    <link>https://iliu.org/tags/cloudflare/</link>
    <description>Recent content in Cloudflare on 老刘博客</description>
    <image>
      <title>老刘博客</title>
      <url>https://iliu.org/img/liujinsuiyue.jpg</url>
      <link>https://iliu.org/img/liujinsuiyue.jpg</link>
    </image>
    <generator>Hugo -- 0.152.2</generator>
    <language>zh-cn</language>
    <lastBuildDate>Fri, 01 Dec 2023 21:04:03 +0800</lastBuildDate>
    <atom:link href="https://iliu.org/tags/cloudflare/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>利用cloudflare页面规则设置301永久跳转</title>
      <link>https://iliu.org/posts/use-cloudflare-page-rules-setup-301-permanent-redirect/</link>
      <pubDate>Fri, 01 Dec 2023 21:04:03 +0800</pubDate>
      <guid>https://iliu.org/posts/use-cloudflare-page-rules-setup-301-permanent-redirect/</guid>
      <description>&lt;h2 id=&#34;前言&#34;&gt;前言&lt;/h2&gt;
&lt;p&gt;细心的读者可能已经发现，图南博客的域名已经由&lt;code&gt;iliu.org&lt;/code&gt; 更换到&lt;code&gt;iliu.org&lt;/code&gt;。这个域名是之前在&lt;code&gt;Google&lt;/code&gt;注册的，可惜的80端口被墙了，也不知道是怎么实现强域名80端口的。于是在暂时使用一段时间后又使用了原域名。&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="前言">前言</h2>
<p>细心的读者可能已经发现，图南博客的域名已经由<code>iliu.org</code> 更换到<code>iliu.org</code>。这个域名是之前在<code>Google</code>注册的，可惜的80端口被墙了，也不知道是怎么实现强域名80端口的。于是在暂时使用一段时间后又使用了原域名。</p>
<p>前两天的时候，感觉还是需要用iliu这个域名，和博客的名字比较搭配，而且用了ssl之后，网站走的443端口，基本上也不会影响什么，所以就切换了过来。</p>
<p>换域名之后另一个需要的解决的事情是要把<code>iliu.org</code>的网址301跳转到新网站，以前用VPS的时候，直接在<code>nginx</code>里设置，现在不用vps了，有没有别的方法呢？答案是肯定的，而且比vps更方便。那就是使用<code>Cloudflare</code>的页面规则进行跳转。</p>
<h2 id="方法">方法</h2>
<p>进入到<code>cloudflare</code>的个人中心，点击需要跳转的网站域名，点击DNS。 把域名解析到8.8.8.8，当然你解析到1.1.1.1也是可以的。然后点击规则，再点击页面规则。具体的设置如下图：<img alt="规则" loading="lazy" src="https://ewader.s3.bitiful.net/blog/guize.png"></p>
<p>这样，就把<code>iliu.org</code>这个网站的网址，按照同样的规则，跳转到了<code>iliu.org</code>这个网站。</p>
<p>使用免费的<code>cloudflare</code>一个域名只有3个免费的页面规则，因此还有另外一个方法也可以实现，那就是利用<code>cloudflare</code>的<code>workers</code>。</p>
<p>进入到<code>cloudflare</code>的后台后，点击<code>Workers 和 Pages</code>。</p>
<p>点击<code>创建应用程序</code>,再点击<code>创建workers</code>：把下面的代码修改一下，复制到代码区保存。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/**</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Welcome</span> <span class="n">to</span> <span class="n">Cloudflare</span> <span class="n">Workers</span><span class="o">!</span> <span class="n">This</span> <span class="n">is</span> <span class="n">your</span> <span class="n">first</span> <span class="n">worker</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="o">-</span> <span class="n">Run</span> <span class="s2">&#34;npm run dev&#34;</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">terminal</span> <span class="n">to</span> <span class="n">start</span> <span class="n">a</span> <span class="n">development</span> <span class="n">server</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="o">-</span> <span class="n">Open</span> <span class="n">a</span> <span class="n">browser</span> <span class="n">tab</span> <span class="n">at</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8787</span><span class="o">/</span> <span class="n">to</span> <span class="n">see</span> <span class="n">your</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">action</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="o">-</span> <span class="n">Run</span> <span class="s2">&#34;npm run deploy&#34;</span> <span class="n">to</span> <span class="n">publish</span> <span class="n">your</span> <span class="n">worker</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span>
</span></span><span class="line"><span class="cl"> <span class="o">*</span> <span class="n">Learn</span> <span class="n">more</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">developers</span><span class="o">.</span><span class="n">cloudflare</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">workers</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"> <span class="o">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">//</span> <span class="n">Redirect</span> <span class="n">requests</span> <span class="n">from</span> <span class="n">one</span> <span class="n">domain</span> <span class="n">to</span> <span class="n">another</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">base</span> <span class="o">=</span> <span class="s2">&#34;https://iliu.org&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">statusCode</span> <span class="o">=</span> <span class="mi">301</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">async</span> <span class="n">function</span> <span class="n">handleRequest</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">url</span> <span class="o">=</span> <span class="n">new</span> <span class="n">URL</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">{</span> <span class="n">pathname</span><span class="p">,</span> <span class="n">search</span> <span class="p">}</span> <span class="o">=</span> <span class="n">url</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">destinationURL</span> <span class="o">=</span> <span class="n">base</span> <span class="o">+</span> <span class="n">pathname</span> <span class="o">+</span> <span class="n">search</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">Response</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="n">destinationURL</span><span class="p">,</span> <span class="n">statusCode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">addEventListener</span><span class="p">(</span><span class="s2">&#34;fetch&#34;</span><span class="p">,</span> <span class="n">async</span> <span class="n">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">event</span><span class="o">.</span><span class="n">respondWith</span><span class="p">(</span><span class="n">handleRequest</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">request</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>上面秩序把域名化成你的域名，然后设置workers的域名是你要转出的域名即可。</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
